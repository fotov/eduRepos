Функция ВерсияДополненияПоХэшу(Хэш) Экспорт

	Результат = Справочники.ВерсииДополнений.ПустаяСсылка();
	
	Если ТипЗнч(Хэш) <> Тип("Строка")
		Или Не ЗначениеЗаполнено(Хэш)
		Или СтрДлина(Хэш) <> 40 Тогда
	
		ВызватьИсключение "Ожидается хэш - строка длиной 40 символов";
	
	КонецЕсли;
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Хэш", Хэш);
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ВерсияДополнения
	|ИЗ
	|	РегистрСведений.КоммитыДополнений
	|ГДЕ
	|	Хеш = &Хэш";
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
	
		Результат = Выборка.ВерсияДополнения;
	
	КонецЕсли;
	
	Возврат Результат;

КонецФункции
